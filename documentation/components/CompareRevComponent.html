<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>ndb-core documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">ndb-core documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content component">
                   <div class="content-data">




<ol class="breadcrumb">
  <li>Components</li>
  <li
  >
  CompareRevComponent</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
        <li >
            <a href="#templateData" role="tab" id="templateData-tab" data-toggle="tab" data-link="template">Template</a>
        </li>
        <li >
            <a href="#styleData" role="tab" id="styleData-tab" data-toggle="tab" data-link="style">Styles</a>
        </li>
        <li >
            <a href="#tree" role="tab" id="tree-tab" data-toggle="tab" data-link="dom-tree">DOM Tree</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info"><p class="comment">
    <h3>File</h3>
</p>
<p class="comment">
    <code>src/app/conflict-resolution/compare-rev/compare-rev.component.ts</code>
</p>


    <p class="comment">
        <h3>Description</h3>
    </p>
    <p class="comment">
        <p>Visualize one specific conflicting document revision and offer resolution options.</p>

    </p>




<section>
    <h3>Metadata</h3>
    <table class="table table-sm table-hover metadata">
        <tbody>











            <tr>
                <td class="col-md-3">selector</td>
                <td class="col-md-9"><code>app-compare-rev</code></td>
            </tr>

            <tr>
                <td class="col-md-3">styleUrls</td>
                <td class="col-md-9"><code>./compare-rev.component.scss</code></td>
            </tr>



            <tr>
                <td class="col-md-3">templateUrl</td>
                <td class="col-md-9"><code>./compare-rev.component.html</code></td>
            </tr>








        </tbody>
    </table>
</section>

    <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#diffs" >diffs</a>
                            </li>
                            <li>
                                <a href="#diffsCustom" >diffsCustom</a>
                            </li>
                            <li>
                                <a href="#diffsReverse" >diffsReverse</a>
                            </li>
                            <li>
                                <a href="#docString" >docString</a>
                            </li>
                            <li>
                                <a href="#resolution" >resolution</a>
                            </li>
                            <li>
                                <a href="#revDoc" >revDoc</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Async</span>
                                <a href="#loadRev" >loadRev</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Async</span>
                                <a href="#resolveByDelete" >resolveByDelete</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                    <span class="modifier">Async</span>
                                <a href="#resolveByManualEdit" >resolveByManualEdit</a>
                            </li>
                            <li>
                                <a href="#stringify" >stringify</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Inputs</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#doc" >doc</a>
                            </li>
                            <li>
                                <a href="#rev" >rev</a>
                            </li>
                        </ul>
                    </td>
                </tr>




        </tbody>
    </table>
</section>

    <section>
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(db: <a href="../classes/Database.html" target="_self">Database</a>, confirmationDialog: <a href="../injectables/ConfirmationDialogService.html" target="_self">ConfirmationDialogService</a>, snackBar: MatSnackBar, conflictResolver: <a href="../injectables/AutoResolutionService.html" target="_self">AutoResolutionService</a>)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="44" class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:44</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>db</td>
                                                  
                                                        <td>
                                                                        <code><a href="../classes/Database.html" target="_self" >Database</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>confirmationDialog</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/ConfirmationDialogService.html" target="_self" >ConfirmationDialogService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>snackBar</td>
                                                  
                                                        <td>
                                                                    <code>MatSnackBar</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>conflictResolver</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/AutoResolutionService.html" target="_self" >AutoResolutionService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

    <section>
    <h3 id="inputs">Inputs</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="doc"></a>
                        <b>doc</b>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </td>
                </tr>
                        <tr>
                            <td class="col-md-2" colspan="2">
                                    <div class="io-line">Defined in <a href="" data-line="22" class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:22</a></div>
                            </td>
                        </tr>
                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>document from the database in the current version</p>
</div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="rev"></a>
                        <b>rev</b>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </td>
                </tr>
                        <tr>
                            <td class="col-md-2" colspan="2">
                                    <div class="io-line">Defined in <a href="" data-line="19" class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:19</a></div>
                            </td>
                        </tr>
                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>revision key (_rev) of the confliction version to be displayed</p>
</div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>



    <section>
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="loadRev"></a>
                    <span class="name">
                        <span class="modifier">Public</span>
                        <span class="modifier">Async</span>
                        <span ><b>loadRev</b></span>
                        <a href="#loadRev"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>loadRev()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="56"
                            class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:56</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Load the document version (revision) to be displayed and generate the diffs to be visualized.</p>
</div>

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="resolveByDelete"></a>
                    <span class="name">
                        <span class="modifier">Public</span>
                        <span class="modifier">Async</span>
                        <span ><b>resolveByDelete</b></span>
                        <a href="#resolveByDelete"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>resolveByDelete(docToDelete: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="93"
                            class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:93</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Resolve the displayed conflict by deleting the conflicting revision doc and keeping the current doc.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>docToDelete</td>
                                    <td>
                                                <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>Document to be deleted</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="resolveByManualEdit"></a>
                    <span class="name">
                        <span class="modifier">Public</span>
                        <span class="modifier">Async</span>
                        <span ><b>resolveByManualEdit</b></span>
                        <a href="#resolveByManualEdit"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>resolveByManualEdit(diffStringToApply: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="144"
                            class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:144</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Apply the given diff, save the resulting new document to the database
and remove the conflicting document, thereby resolving the conflict.</p>
<p>This method is also used to resolve the conflict to keep the conflicting version instead of the current doc.
Then this simply applies the diff of the existing conflicting version instead of a user-edited diff.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>diffStringToApply</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>The (user-edited) diff to be applied to the current doc</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="stringify"></a>
                    <span class="name">
                        <span ><b>stringify</b></span>
                        <a href="#stringify"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>stringify(entity: <a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank">any</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="81"
                            class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:81</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>Generate a human-readable string of the given object.</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                    <td>Description</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>entity</td>
                                    <td>
                                                <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                    <td>
                                        <p>Object to be stringified</p>

                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>
    <section>
    
    <h3 id="inputs">
        Properties
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="diffs"></a>
                    <span class="name">
                        <span ><b>diffs</b></span>
                        <a href="#diffs"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="31" class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:31</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>changes the conflicting doc has compared to the current doc</p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="diffsCustom"></a>
                    <span class="name">
                        <span ><b>diffsCustom</b></span>
                        <a href="#diffsCustom"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="41" class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:41</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>the user edited diff that can be applied as an alternative resolution (initialized with same value as <code>diffs</code>)</p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="diffsReverse"></a>
                    <span class="name">
                        <span ><b>diffsReverse</b></span>
                        <a href="#diffsReverse"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="38" class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:38</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>changes the current doc has compared to the conflicting doc.</p>
<p>This mirrors <code>diffs</code> but shows the things that would be added if the current doc would
overwrite the conflicting version instead of the other way round.</p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="docString"></a>
                    <span class="name">
                        <span ><b>docString</b></span>
                        <a href="#docString"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="25" class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:25</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>used in the template for a tooltip displaying the full document</p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="resolution"></a>
                    <span class="name">
                        <span ><b>resolution</b></span>
                        <a href="#resolution"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Default value : </i><code>null</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="44" class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:44</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>whether/how this conflict has been resolved</p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="revDoc"></a>
                    <span class="name">
                        <span ><b>revDoc</b></span>
                        <a href="#revDoc"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
                <tr>
                    <td class="col-md-4">
                        <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="28" class="link-to-prism">src/app/conflict-resolution/compare-rev/compare-rev.component.ts:28</a></div>
                        </td>
                    </tr>

            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>document from the database in the conflicting version</p>
</div>
                </td>
            </tr>

        </tbody>
    </table>
</section>

</div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Component, Input } from &quot;@angular/core&quot;;
import { diff } from &quot;deep-object-diff&quot;;
import { ConfirmationDialogService } from &quot;../../core/confirmation-dialog/confirmation-dialog.service&quot;;
import { Database } from &quot;../../core/database/database&quot;;
import { MatSnackBar } from &quot;@angular/material/snack-bar&quot;;
import { AutoResolutionService } from &quot;../auto-resolution/auto-resolution.service&quot;;
import { merge } from &quot;lodash-es&quot;;

/**
 * Visualize one specific conflicting document revision and offer resolution options.
 */
@Component({
  selector: &quot;app-compare-rev&quot;,
  templateUrl: &quot;./compare-rev.component.html&quot;,
  styleUrls: [&quot;./compare-rev.component.scss&quot;],
})
export class CompareRevComponent {
  /** revision key (_rev) of the confliction version to be displayed */
  @Input() rev: string;

  /** document from the database in the current version */
  @Input() doc: any;

  /** used in the template for a tooltip displaying the full document */
  docString: string;

  /** document from the database in the conflicting version */
  revDoc: any;

  /** changes the conflicting doc has compared to the current doc */
  diffs;

  /** changes the current doc has compared to the conflicting doc.
   *
   * This mirrors &#x60;diffs&#x60; but shows the things that would be added if the current doc would
   * overwrite the conflicting version instead of the other way round.
   */
  diffsReverse;

  /** the user edited diff that can be applied as an alternative resolution (initialized with same value as &#x60;diffs&#x60;) */
  diffsCustom;

  /** whether/how this conflict has been resolved */
  resolution: string &#x3D; null;

  constructor(
    private db: Database,
    private confirmationDialog: ConfirmationDialogService,
    private snackBar: MatSnackBar,
    private conflictResolver: AutoResolutionService
  ) {}

  /**
   * Load the document version (revision) to be displayed and generate the diffs to be visualized.
   */
  public async loadRev() {
    this.revDoc &#x3D; await this.db.get(this.doc._id, { rev: this.rev });
    const diffObject &#x3D; diff(this.doc, this.revDoc);
    this.diffs &#x3D; this.stringify(diffObject);

    const diffReverseObject &#x3D; diff(this.revDoc, this.doc);
    this.diffsReverse &#x3D; this.stringify(diffReverseObject);
    this.diffsCustom &#x3D; this.stringify(diffReverseObject);

    const isIrrelevantConflictingDoc &#x3D; this.conflictResolver.shouldDeleteConflictingRevision(
      this.doc,
      this.revDoc
    );
    if (isIrrelevantConflictingDoc) {
      const success &#x3D; await this.deleteDoc(this.revDoc);
      if (success) {
        this.resolution &#x3D; $localize&#x60;automatically deleted trivial conflict&#x60;;
      }
    }
  }

  /**
   * Generate a human-readable string of the given object.
   * @param entity Object to be stringified
   */
  stringify(entity: any) {
    return JSON.stringify(
      entity,
      (k, v) &#x3D;&gt; (k &#x3D;&#x3D;&#x3D; &quot;_rev&quot; ? undefined : v), // ignore &quot;_rev&quot;
      2
    );
  }

  /**
   * Resolve the displayed conflict by deleting the conflicting revision doc and keeping the current doc.
   * @param docToDelete Document to be deleted
   */
  public async resolveByDelete(docToDelete: any) {
    const confirmed &#x3D; await this.confirmationDialog.getConfirmation(
      $localize&#x60;Delete Conflicting Version?&#x60;,
      $localize&#x60;Are you sure you want to keep the current version and delete this conflicting version? ${this.stringify(
        docToDelete
      )}&#x60;
    );

    if (confirmed) {
      const success &#x3D; await this.deleteDoc(docToDelete);
      if (success) {
        this.resolution &#x3D; $localize&#x60;deleted conflicting version&#x60;;
      }
    }
  }

  private async deleteDoc(docToDelete: any): Promise&lt;boolean&gt; {
    try {
      await this.db.remove(docToDelete);
      return true;
    } catch (e) {
      const errorMessage &#x3D; e.message || e.toString();
      this.snackBar.open(
        $localize&#x60;Error trying to delete conflicting version: ${errorMessage}&#x60;
      );
      return false;
    }
  }

  private async saveDoc(docToSave: any): Promise&lt;boolean&gt; {
    try {
      await this.db.put(docToSave);
      return true;
    } catch (e) {
      const errorMessage &#x3D; e.message || e.toString();
      this.snackBar.open(
        $localize&#x60;Error trying to save version: ${errorMessage}&#x60;
      );
      return false;
    }
  }

  /**
   * Apply the given diff, save the resulting new document to the database
   * and remove the conflicting document, thereby resolving the conflict.
   *
   * This method is also used to resolve the conflict to keep the conflicting version instead of the current doc.
   * Then this simply applies the diff of the existing conflicting version instead of a user-edited diff.
   *
   * @param diffStringToApply The (user-edited) diff to be applied to the current doc
   */
  public async resolveByManualEdit(diffStringToApply: string) {
    const originalDoc &#x3D; merge({}, this.doc);
    const diffToApply &#x3D; JSON.parse(diffStringToApply);
    merge(this.doc, diffToApply);

    const newChanges &#x3D; diff(originalDoc, this.doc);

    const confirmed &#x3D; await this.confirmationDialog.getConfirmation(
      $localize&#x60;Save Changes for Conflict Resolution?&#x60;,
      $localize&#x60;Are you sure you want to save the following changes and delete the conflicting version? ${this.stringify(
        newChanges
      )}&#x60;
    );
    if (confirmed) {
      const successSave &#x3D; await this.saveDoc(this.doc);
      const successDel &#x3D; await this.deleteDoc(this.revDoc);
      if (successSave &amp;&amp; successDel) {
        if (diffStringToApply &#x3D;&#x3D;&#x3D; this.diffs) {
          this.resolution &#x3D; $localize&#x60;selected conflicting version&#x60;;
        } else {
          this.resolution &#x3D; $localize&#x60;resolved manually&#x60;;
        }
      }
    }
  }
}
</code></pre>
    </div>

    <div class="tab-pane fade " id="c-templateData">
        <pre class="line-numbers"><code class="language-html">&lt;mat-expansion-panel (opened)&#x3D;&quot;loadRev()&quot; *ngIf&#x3D;&quot;!resolution&quot;&gt;
  &lt;mat-expansion-panel-header&gt;
    &lt;mat-panel-title&gt;
      &lt;span [matTooltip]&#x3D;&quot;docString&quot; (mouseover)&#x3D;&quot;docString &#x3D; stringify(doc)&quot;&gt;{{
        rev
      }}&lt;/span&gt;
    &lt;/mat-panel-title&gt;
  &lt;/mat-expansion-panel-header&gt;

  &lt;div fxLayout&#x3D;&quot;row&quot; fxLayoutGap&#x3D;&quot;10px&quot;&gt;
    &lt;div fxFlex&#x3D;&quot;50&quot;&gt;
      &lt;label
        for&#x3D;&quot;conflictingDiff&quot;
        i18n&#x3D;&quot;Signals that there are conflicting database-entities&quot;
      &gt;
        Conflicting Entity:
      &lt;/label&gt;
      &lt;textarea
        id&#x3D;&quot;conflictingDiff&quot;
        cdkTextareaAutosize
        class&#x3D;&quot;diffText conflicting&quot;
        disabled
      &gt;
        {{ diffs }}
      &lt;/textarea&gt;
      &lt;button
        mat-raised-button
        class&#x3D;&quot;resolution-btn&quot;
        (click)&#x3D;&quot;resolveByManualEdit(diffs)&quot;
        i18n
      &gt;
        Choose conflicting version
      &lt;/button&gt;
    &lt;/div&gt;

    &lt;div fxFlex&#x3D;&quot;50&quot;&gt;
      &lt;label for&#x3D;&quot;customDiff&quot;&gt;Custom Resolution:&lt;/label&gt;
      &lt;textarea
        id&#x3D;&quot;customDiff&quot;
        cdkTextareaAutosize
        class&#x3D;&quot;diffText custom&quot;
        [(ngModel)]&#x3D;&quot;diffsCustom&quot;
      &gt;
      &lt;/textarea&gt;
      &lt;button
        mat-raised-button
        class&#x3D;&quot;resolution-btn&quot;
        (click)&#x3D;&quot;resolveByManualEdit(diffsCustom)&quot;
        i18n
      &gt;
        Save manually resolved record
      &lt;/button&gt;
    &lt;/div&gt;

    &lt;div fxFlex&#x3D;&quot;50&quot;&gt;
      &lt;label for&#x3D;&quot;currentDiff&quot; i18n&#x3D;&quot;A currently selected entity&quot;&gt;
        Current Entity:
      &lt;/label&gt;
      &lt;textarea
        id&#x3D;&quot;currentDiff&quot;
        cdkTextareaAutosize
        class&#x3D;&quot;diffText current&quot;
        disabled
      &gt;
        {{ diffsReverse }}
      &lt;/textarea&gt;
      &lt;button
        mat-raised-button
        class&#x3D;&quot;resolution-btn&quot;
        (click)&#x3D;&quot;resolveByDelete(revDoc)&quot;
        i18n&#x3D;&quot;
          Choose a current version between several conflicting versions of
          database entries
        &quot;
      &gt;
        Choose current version
      &lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/mat-expansion-panel&gt;

&lt;div *ngIf&#x3D;&quot;resolution&quot;&gt;
  &lt;em&gt;Resolved ({{ resolution }})&lt;/em&gt;
&lt;/div&gt;
</code></pre>
    </div>

    <div class="tab-pane fade " id="c-styleData">
                <p class="comment">
                    <code>./compare-rev.component.scss</code>
                </p>
                <pre class="line-numbers"><code class="language-scss">.diffText {
  width: 100%;
  background: white;
}

.resolution-btn {
  width: 100%;
}

.conflicting {
  background: rgba(255, 0, 0, 0.1);
}
.current {
  background: rgba(0, 128, 0, 0.1);
}
.custom {
  background: rgba(0, 0, 255, 0.1);
  font-weight: bold;
}
</code></pre>
    </div>

    <div class="tab-pane fade " id="c-tree">
        <div id="tree-container"></div>
        <div class="tree-legend">
            <div class="title">
                <b>Legend</b>
            </div>
            <div>
                <div class="color htmlelement"></div><span>Html element</span>
            </div>
            <div>
                <div class="color component"></div><span>Component</span>
            </div>
            <div>
                <div class="color directive"></div><span>Html element with directive</span>
            </div>
        </div>
    </div>

    
</div>

<script src="../js/libs/vis.min.js"></script>
<script src="../js/libs/htmlparser.js"></script>
<script src="../js/libs/deep-iterator.js"></script>
<script>
        var COMPONENT_TEMPLATE = '<div><mat-expansion-panel (opened)="loadRev()" *ngIf="!resolution">  <mat-expansion-panel-header>    <mat-panel-title>      <span [matTooltip]="docString" (mouseover)="docString = stringify(doc)">{{        rev      }}</span>    </mat-panel-title>  </mat-expansion-panel-header>  <div fxLayout="row" fxLayoutGap="10px">    <div fxFlex="50">      <label        for="conflictingDiff"        i18n="Signals that there are conflicting database-entities"      >        Conflicting Entity:      </label>      <textarea        id="conflictingDiff"        cdkTextareaAutosize        class="diffText conflicting"        disabled      >        {{ diffs }}      </textarea>      <button        mat-raised-button        class="resolution-btn"        (click)="resolveByManualEdit(diffs)"        i18n      >        Choose conflicting version      </button>    </div>    <div fxFlex="50">      <label for="customDiff">Custom Resolution:</label>      <textarea        id="customDiff"        cdkTextareaAutosize        class="diffText custom"        [(ngModel)]="diffsCustom"      >      </textarea>      <button        mat-raised-button        class="resolution-btn"        (click)="resolveByManualEdit(diffsCustom)"        i18n      >        Save manually resolved record      </button>    </div>    <div fxFlex="50">      <label for="currentDiff" i18n="A currently selected entity">        Current Entity:      </label>      <textarea        id="currentDiff"        cdkTextareaAutosize        class="diffText current"        disabled      >        {{ diffsReverse }}      </textarea>      <button        mat-raised-button        class="resolution-btn"        (click)="resolveByDelete(revDoc)"        i18n="          Choose a current version between several conflicting versions of          database entries        "      >        Choose current version      </button>    </div>  </div></mat-expansion-panel><div *ngIf="resolution">  <em>Resolved ({{ resolution }})</em></div></div>'
    var COMPONENTS = [{'name': 'ActivitiesOverviewComponent', 'selector': 'app-activities-overview'},{'name': 'ActivityAttendanceSectionComponent', 'selector': 'app-activity-attendance-section'},{'name': 'ActivityCardComponent', 'selector': 'app-activity-card'},{'name': 'AddDayAttendanceComponent', 'selector': 'app-add-day-attendance'},{'name': 'AdminComponent', 'selector': 'app-admin'},{'name': 'AlertComponent', 'selector': ''},{'name': 'AppComponent', 'selector': 'app-root'},{'name': 'ApplicationLoadingComponent', 'selector': ''},{'name': 'AppVersionComponent', 'selector': 'app-version'},{'name': 'AserComponent', 'selector': 'app-aser'},{'name': 'AttendanceBlockComponent', 'selector': 'app-attendance-block'},{'name': 'AttendanceCalendarComponent', 'selector': 'app-attendance-calendar'},{'name': 'AttendanceDayBlockComponent', 'selector': 'app-attendance-day-block]'},{'name': 'AttendanceDetailsComponent', 'selector': 'app-attendance-details'},{'name': 'AttendanceManagerComponent', 'selector': 'app-attendance-manager'},{'name': 'AttendanceStatusSelectComponent', 'selector': 'app-attendance-status-select'},{'name': 'AttendanceSummaryComponent', 'selector': 'app-attendance-summary'},{'name': 'AttendanceWeekDashboardComponent', 'selector': 'app-attendance-week-dashboard'},{'name': 'BackgroundProcessingIndicatorComponent', 'selector': 'app-background-processing-indicator'},{'name': 'BirthdayDashboardComponent', 'selector': 'app-birthday-dashboard'},{'name': 'BmiBlockComponent', 'selector': 'app-bmi-block'},{'name': 'ChangelogComponent', 'selector': ''},{'name': 'ChildBlockComponent', 'selector': 'app-child-block'},{'name': 'ChildMeetingNoteAttendanceComponent', 'selector': 'app-child-meeting-note-attendance'},{'name': 'ChildrenBmiDashboardComponent', 'selector': 'app-children-bmi-dashboard'},{'name': 'ChildrenCountDashboardComponent', 'selector': 'app-children-count-dashboard'},{'name': 'ChildrenListComponent', 'selector': 'app-children-list'},{'name': 'ChildrenOverviewComponent', 'selector': 'app-children-overview'},{'name': 'ComingSoonComponent', 'selector': 'app-coming-soon'},{'name': 'CompareRevComponent', 'selector': 'app-compare-rev'},{'name': 'ConfirmationDialogComponent', 'selector': 'app-confirmation-dialog'},{'name': 'ConflictResolutionListComponent', 'selector': 'app-conflict-resolution-list'},{'name': 'DashboardComponent', 'selector': 'app-dashboard'},{'name': 'DashboardShortcutWidgetComponent', 'selector': 'app-dashboard-shortcut-widget'},{'name': 'DashboardWidgetComponent', 'selector': 'app-dashboard-widget'},{'name': 'DataImportComponent', 'selector': 'app-data-import'},{'name': 'DemoDataGeneratingProgressDialogComponent', 'selector': ''},{'name': 'DisabledWrapperComponent', 'selector': 'app-disabled-wrapper'},{'name': 'DisplayCheckmarkComponent', 'selector': 'app-display-tick'},{'name': 'DisplayConfigurableEnumComponent', 'selector': 'app-display-configurable-enum'},{'name': 'DisplayDateComponent', 'selector': 'app-display-date'},{'name': 'DisplayEntityArrayComponent', 'selector': 'app-display-entity-array'},{'name': 'DisplayEntityComponent', 'selector': 'app-display-entity'},{'name': 'DisplayPercentageComponent', 'selector': 'app-display-percentage'},{'name': 'DisplayTextComponent', 'selector': 'app-display-text'},{'name': 'DisplayUnitComponent', 'selector': 'app-display-unit'},{'name': 'EditAgeComponent', 'selector': 'app-edit-age'},{'name': 'EditBooleanComponent', 'selector': 'app-edit-boolean'},{'name': 'EditConfigurableEnumComponent', 'selector': 'app-edit-configurable-enum'},{'name': 'EditDateComponent', 'selector': 'app-edit-date'},{'name': 'EditEntityArrayComponent', 'selector': 'app-edit-entity-array'},{'name': 'EditLongTextComponent', 'selector': 'app-edit-long-text'},{'name': 'EditNumberComponent', 'selector': 'app-edit-number'},{'name': 'EditPhotoComponent', 'selector': 'app-edit-photo'},{'name': 'EditProgressDashboardComponent', 'selector': 'app-edit-progress-dashboard'},{'name': 'EditSingleEntityComponent', 'selector': 'app-edit-single-entity'},{'name': 'EditTextComponent', 'selector': 'app-edit-text'},{'name': 'EducationalMaterialComponent', 'selector': 'app-educational-material'},{'name': 'EntityDetailsComponent', 'selector': 'app-entity-details'},{'name': 'EntityFormComponent', 'selector': 'app-entity-form'},{'name': 'EntityListComponent', 'selector': 'app-entity-list'},{'name': 'EntitySelectComponent', 'selector': 'app-entity-select'},{'name': 'EntitySubrecordComponent', 'selector': 'app-entity-subrecord'},{'name': 'ErrorHintComponent', 'selector': 'app-error-hint'},{'name': 'FaDynamicIconComponent', 'selector': 'app-fa-dynamic-icon'},{'name': 'FilterOverlayComponent', 'selector': 'app-filter-overlay'},{'name': 'FormComponent', 'selector': 'app-form'},{'name': 'FormDialogWrapperComponent', 'selector': 'app-form-dialog-wrapper'},{'name': 'GroupedChildAttendanceComponent', 'selector': 'app-grouped-child-attendance'},{'name': 'HealthCheckupComponent', 'selector': 'app-health-checkup'},{'name': 'HistoricalDataComponent', 'selector': 'app-historical-data'},{'name': 'LanguageSelectComponent', 'selector': 'app-language-select'},{'name': 'ListFilterComponent', 'selector': 'app-list-filter'},{'name': 'ListPaginatorComponent', 'selector': 'app-list-paginator'},{'name': 'LoginComponent', 'selector': 'app-login'},{'name': 'MarkdownPageComponent', 'selector': 'app-markdown-page'},{'name': 'NavigationComponent', 'selector': 'app-navigation'},{'name': 'NoteAttendanceCountBlockComponent', 'selector': 'app-note-attendance-count-block'},{'name': 'NoteDetailsComponent', 'selector': 'app-note-details'},{'name': 'NotesDashboardComponent', 'selector': 'app-no-recent-notes-dashboard'},{'name': 'NotesManagerComponent', 'selector': 'app-notes-manager'},{'name': 'NotesOfChildComponent', 'selector': 'app-notes-of-child'},{'name': 'NotFoundComponent', 'selector': 'app-not-found'},{'name': 'ObjectTableComponent', 'selector': 'app-object-table'},{'name': 'PreviousSchoolsComponent', 'selector': 'app-previous-schools'},{'name': 'PrimaryActionComponent', 'selector': 'app-primary-action'},{'name': 'ProgressDashboardComponent', 'selector': 'app-progress-dashboard'},{'name': 'PwaInstallComponent', 'selector': 'app-pwa-install'},{'name': 'ReadonlyFunctionComponent', 'selector': 'app-readonly-function'},{'name': 'RecentAttendanceBlocksComponent', 'selector': 'app-recent-attendance-blocks'},{'name': 'ReportingComponent', 'selector': 'app-reporting'},{'name': 'ReportRowComponent', 'selector': 'app-report-row'},{'name': 'RollCallComponent', 'selector': 'app-roll-call'},{'name': 'RollCallSetupComponent', 'selector': 'app-roll-call-setup'},{'name': 'RollCallTabComponent', 'selector': 'app-roll-call-tab'},{'name': 'RowDetailsComponent', 'selector': 'app-row-details'},{'name': 'SchoolBlockComponent', 'selector': 'app-school-block'},{'name': 'SearchComponent', 'selector': 'app-search'},{'name': 'SelectReportComponent', 'selector': 'app-select-report'},{'name': 'SupportComponent', 'selector': 'app-support'},{'name': 'SyncStatusComponent', 'selector': 'app-sync-status'},{'name': 'UiComponent', 'selector': 'app-ui'},{'name': 'UserAccountComponent', 'selector': 'app-user-account'},{'name': 'ViewTitleComponent', 'selector': 'app-view-title'},{'name': 'WidgetContentComponent', 'selector': 'app-widget-content'}];
    var DIRECTIVES = [{'name': 'ConfigurableEnumDirective', 'selector': '[appConfigurableEnum]'},{'name': 'DisableEntityOperationDirective', 'selector': '[appDisabledEntityOperation]'},{'name': 'DynamicComponentDirective', 'selector': '[appDynamicComponent]'},{'name': 'ExportDataDirective', 'selector': '[appExportData]'},{'name': 'TabStateMemoDirective', 'selector': '[appTabStateMemo]'},{'name': 'ViewDirective', 'selector': ''}];
    var ACTUAL_COMPONENT = {'name': 'CompareRevComponent'};
</script>
<script src="../js/tree.js"></script>

















                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'component';
            var COMPODOC_CURRENT_PAGE_URL = 'CompareRevComponent.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
